<!DOCTYPE html>
<html>
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<!--<meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> -->
	<!--<meta name="apple-mobile-web-app-capable" content="yes">-->
	<!--<meta name="mobile-web-app-capable" content="yes">-->
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Bootstrap Core CSS -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="/freelancer.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">

	<!-- Customized CSS -->
	<link href="/customize.css" rel="stylesheet" type="text/css">

    <title>Whaddat? - Exploring the Unknown</title>
    <body id="page-top" class="index">
      <!-- Navigation -->
      <nav id="mainNav" class="navbar navbar-default navbar-fixed-top navbar-custom">
          <div class="container">
              <!-- Brand and toggle get grouped for better mobile display -->
              <div class="navbar-header page-scroll">
                  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                      <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i>
                  </button>
                  <a class="navbar-brand" href="#page-top">Whaddat?</a>
              </div>

              <!-- Collect the nav links, forms, and other content for toggling -->
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                  <ul class="nav navbar-nav navbar-right">
                      <li class="hidden">
                          <a href="#page-top"></a>
                      </li>
                      <li class="page-scroll">
                          <a href="#portfolio">Portfolio</a>
                      </li>
                      <li class="page-scroll">
                          <a href="#about">About</a>
                      </li>
                      <li class="page-scroll">
                          <a href="#contact">Contact</a>
                      </li>
                  </ul>
              </div>
              <!-- /.navbar-collapse -->
          </div>
          <!-- /.container-fluid -->
      </nav>

  <!-- Header -->
   <header>
	<section>
       <div class="container" id="maincontent" tabindex="-1">
           <div class="row">
               <div class="col-lg-12">
                   <img id="blah" class="img-responsive" src="profile.png" alt="">
                   <button type="button" class = "btn btn-default" id="uploadBtn" style="display:none;">Capture</button>

                   <!-- <input id="playSoundDOM" onclick='playSound()' type='button' value='ðŸ”Š Play' style="display:none;" /> -->
                   <div class="intro-text">
					   <div id="playSoundDOM">
					      <h1 class="name">What's that?</h1>
					   </div>
					   <div class="div-uploader">
					       <p><b>Capture or upload an object</b></p>
						   <input type="file" accept="image/*" name="fileToUpload" id="fileToUpload" class="file-uploader center" onchange="readURL(this)">
					   </div>
                       <hr class="star-light">
                       <span class="skills">Every moment is a learning moment</span>
                   </div>
               </div>
           </div>
       </div>
	</section>
   </header>

   <!-- Portfolio Grid Section -->
   <section id="portfolio">
       <div class="container">
           <div class="row">
               <div class="col-lg-12 text-center">
                   <h2>Guides</h2>
                   <hr class="star-primary">
               </div>
           </div>
           <div class="row guide-items">
                <div class="col-sm-4 portfolio-item">
                   <a href="/catHtml" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="portfolio/cabin.png" class="img-responsive" alt="Cabin">
                   </a>
               </div>
               <!-- <div class="col-sm-4 portfolio-item">
                   <a href="#portfolioModal2" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="portfolio/cake.png" class="img-responsive" alt="Slice of cake">
                   </a>
               </div>
               <div class="col-sm-4 portfolio-item">
                   <a href="#portfolioModal3" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="portfolio/circus.png" class="img-responsive" alt="Circus tent">
                   </a>
               </div>
               <div class="col-sm-4 portfolio-item">
                   <a href="#portfolioModal4" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="portfolio/game.png" class="img-responsive" alt="Game controller">
                   </a>
               </div>
               <div class="col-sm-4 portfolio-item">
                   <a href="#portfolioModal5" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="portfolio/safe.png" class="img-responsive" alt="Safe">
                   </a>
               </div> -->
               <!-- <div class="col-sm-4 portfolio-item">
                   <a href="#portfolioModal6" class="portfolio-link" data-toggle="modal">
                       <div class="caption">
                           <div class="caption-content">
                               <i class="fa fa-search-plus fa-3x"></i>
                           </div>
                       </div>
                       <img src="Contentpic-2.png" class="img-responsive" alt="Submarine">
                       <p>Different types of Cat Fur</p>
                   </a>
               </div> -->
           </div>
       </div>
   </section>

   <!-- Statistics Grid Section -->
   <section id="statistics">
       <div class="container">
	      <div id="plotholder">
	         <h3>Browsing Statistics</h3>
	         <div id="placeholder" style="width:100%;height:500px;" />
		  </div>
	   </div>
   </section>

        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
        <script type="text/javascript" src="/jquery/jquery.min.js"></script>
        <script type="text/javascript" src='https://code.responsivevoice.org/responsivevoice.js'></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.loadingoverlay/latest/loadingoverlay.min.js"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery.loadingoverlay/latest/loadingoverlay_progress.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.js"></script>

        <script type="text/javascript">

        var data = [[0, 11],[1, 15],[2, 25],[3, 24],[4, 13],[5, 18]];
        var dataset = [{ data: data, color: "#5482FF" }];
        var ticks = [[0, "London"], [1, "New York"], [2, "New Delhi"], [3, "Taipei"],[4, "Beijing"], [5, "Sydney"]];

		var options = {
            series: {
                bars: {
                    show: true
                }
            },
            bars: {
                align: "center",
                barWidth: 0.5
            },
            xaxis: {
                //axisLabel: "World Cities",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 16,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 10,
                ticks: ticks
            },
            yaxis: {
                //axisLabel: "Average Temperature",
                axisLabelUseCanvas: true,
                axisLabelFontSizePixels: 16,
                axisLabelFontFamily: 'Verdana, Arial',
                axisLabelPadding: 3,
                tickFormatter: function (v, axis) {
                    return v;
                }
            },
            legend: {
                noColumns: 0,
                labelBoxBorderColor: "#000000",
                position: "nw"
            },
            grid: {
                hoverable: true,
                borderWidth: 2,
                backgroundColor: { colors: ["#ffffff", "#EDF5FF"] }
            }
        };

		$(document).ready(function(){
			$.plot($("#placeholder"), dataset, options);

			var xaxisLabel = $("<div class='axisLabel xaxisLabel'></div>")
			  .text("Interest")
			  .appendTo($('#placeholder'));

			var yaxisLabel = $("<div class='axisLabel yaxisLabel'></div>")
			  .text("Count")
			  .appendTo($('#placeholder'));
		});
		</script>

		<script type="text/javascript">
		$('#portfolio').hide();

        $( "#fileToUpload" ).change(function() {
          //automatically upload the image
          $( "#uploadBtn" ).click();
          $( "#fileToUpload" ).hide();
          });

                var socket = io.connect("/");
                var labelOfImage = null;

                function readURL(input) {
                  if (input.files && input.files[0]) {
                      var reader = new FileReader();

                      reader.onload = function (e) {
                          $('#blah')
                              .attr('src', e.target.result)
                              .height(200);
                      };

                      reader.readAsDataURL(input.files[0]);
                  }
                }

                function playSound() {
                  responsiveVoice.speak(labelOfImage);
                }
                /*Initializing the connection with the server via websockets */
                socket.on("label",function(jsonObj){
                    /*
                        When server sends data to the client it will trigger "label" event on the client side , by
                        using socket.on("label") , one can listen for the ,label event and associate a callback to
                        be executed . The Callback function gets the data sent from the server
                    */
                    console.log("Message from the server arrived");
                    //label = JSON.stringify(label, undefined, 2);
                    console.log(jsonObj.imageLabel); /*converting the data into JS object */
                    labelOfImage = jsonObj.imageLabel;
					          $('#playSoundDOM img').remove();
                    $('.name')[0].innerHTML = "";//remove the title and replace with label
                    $('.name').append('<div >'+jsonObj.imageLabel+'</div>');
                    //display sound icon
                    var playSoundEle = $("<img src='voiceOver.png' onclick='playSound()' style='width: 50px'/>");
                    $('#playSoundDOM').append(playSoundEle);
                    playSound();

                    for (var i = 0; i < jsonObj.articles.length; i++) {
          						var fragment = $('<a/>').addClass('fragment').attr({'href':jsonObj.articles[i].urlLink});
          						$(fragment).append($('<img/>').addClass('img-responsive').attr({'alt':'preview', 'width':'100%;', 'src':jsonObj.articles[i].thumbnails.url}));
          						$(fragment).append($('<h4/>').html(jsonObj.articles[i].title));
          						$(fragment).append($('<p/>').html(jsonObj.articles[i].description));

          						var domElement = $('<div/>').addClass('col-sm-4 portfolio-item');
          						$(domElement).append(fragment);
          						$('.guide-items')[0].append(domElement[0]);

                      /*var domElement = $("<div class='col-sm-4 portfolio-item'><a href=" + jsonObj.articles[i].urlLink + " target='_blank' class='portfolio-link' data-toggle='modal'><div class='caption'>" +
                      "<div class='caption-content'><i class='fa fa-search-plus fa-3x'></i></div></div><img src="
                      + jsonObj.articles[i].thumbnails.url
                      + " class='img-responsive center result-thumbnais'/><p>" + jsonObj.articles[i].title +  "</p></a></div>");
                      $('.guide-items')[0].append(domElement[0]);*/
                    };

          					$('#fileToUpload').show();
          					$('.intro-text .div-uploader').LoadingOverlay("hide");
          					$('#portfolio').show();

                });
                $(function(){
                    $('#uploadBtn').click(function(){ /*listening to the button click using Jquery listener*/
        						$('.guide-items').empty();

        						$('.intro-text .div-uploader').LoadingOverlay("show");
        						$('#portfolio').hide();

                      //Get the first (and only one) file element
                      //that is included in the original event
                      var file = $("input[type=file]")[0].files[0];
                          reader = new FileReader();
                      //When the file has been read...
                      reader.onload = function(evt){
                          //Because of how the file was read,
                          //evt.target.result contains the image in base64 format
                          //Nothing special, just creates an img element
                          //and appends it to the DOM so my UI shows
                          //that I posted an image.
                          //send the image via Socket.io
                          var jsonObj = {
                            imageName: file.name,
                            imageData: evt.target.result
                          }

                          socket.emit('imgToDetect', JSON.stringify(jsonObj));
                      };
                      //And now, read the image and base64
                      reader.readAsDataURL(file);

                      //Emptying the text box value using jquery
                      $('#fileToUpload').val('');

                        return false;
                    });
                });

        </script>

    </body>
  </head>
</html>
